(function(){"use strict";var t={8643:function(t,e,r){var s=r(6369),a=function(){var t=this,e=t._self._c;return e("div",[e("header",{staticClass:"header"},[e("div",{staticClass:"container header__container"},[e("router-link",{staticClass:"header__catalog-link link",attrs:{to:{name:"catalog"}}},[t._v("Каталог")]),t._m(0),e("div",{staticClass:"header__content"},[e("a",{staticClass:"header__tel common-font link",attrs:{href:"tel:8 800 600 90 09"}},[t._v("8 800 600 90 09")]),e("button",{staticClass:"header__search-btn"},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.2239 3.09729C16.0203 5.89367 16.0203 10.4275 13.2239 13.2239C10.4275 16.0203 5.89367 16.0203 3.09729 13.2239C0.300904 10.4275 0.300904 5.89367 3.09729 3.09729C5.89367 0.300904 10.4275 0.300904 13.2239 3.09729ZM13.9524 13.9095C17.1179 10.7209 17.1107 5.56993 13.931 2.39018C10.7441 -0.796727 5.57709 -0.796727 2.39018 2.39018C-0.796727 5.57709 -0.796727 10.7441 2.39018 13.931C5.56993 17.1107 10.7209 17.1179 13.9095 13.9524L13.2096 14.6523L18.2587 19.7014C18.6571 20.0998 19.303 20.0998 19.7013 19.7014C20.0997 19.303 20.0997 18.6572 19.7013 18.2588L14.6522 13.2097L13.9524 13.9095Z",fill:"black"}})])]),e("cartIndicator")],1)],1)]),e("router-view"),e("footer",{staticClass:"footer"},[e("div",{staticClass:"container footer__container"},[e("router-link",{staticClass:"footer__nav-link footer__nav-link_catalog link",attrs:{to:{name:"catalog"}}},[t._v("Каталог")]),e("a",{staticClass:"footer__nav-link footer__nav-link_sale link",attrs:{href:"#"}},[t._v("Распродажа")]),e("a",{staticClass:"common-font footer__nav-link_phone link",attrs:{href:"tel:8 800 600 90 09"}},[t._v("8 800 600 90 09")]),e("a",{staticClass:"footer__recall-link link",attrs:{href:""}},[t._v("Заказать звонок")]),e("a",{staticClass:"footer__mail common-font link",attrs:{href:"mailto:hello@moire.com"}},[t._v("hello@moire.com")]),e("ul",{staticClass:"footer__social social"},[e("li",[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Вконтакте"}},[e("svg",{attrs:{width:"20",height:"11",fill:"currentColor"}},[e("use",{attrs:{href:"#icon-vk"}})])])]),e("li",[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Инстаграм"}},[e("svg",{attrs:{width:"17",height:"17",fill:"currentColor"}},[e("use",{attrs:{href:"#icon-insta"}})])])]),e("li",[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Facebook"}},[e("svg",{attrs:{width:"17",height:"17",fill:"currentColor"}},[e("use",{attrs:{href:"#icon-facebook"}})])])]),e("li",[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Twitter"}},[e("svg",{attrs:{width:"17",height:"14",fill:"currentColor"}},[e("use",{attrs:{href:"#icon-twitter"}})])])]),e("li",[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Telegram"}},[e("svg",{attrs:{width:"19",height:"17",fill:"currentColor"}},[e("use",{attrs:{href:"#icon-telegram"}})])])])]),e("p",{staticClass:"note footer__note"},[t._v("Все права на материалы, находящиеся на сайте, охраняются в соответствии с законодательством РФ, в том числе об авторском праве и смежных правах.")]),t._m(1)],1)])],1)},o=[function(){var t=this,e=t._self._c;return e("a",{staticClass:"header__logo",attrs:{href:""}},[e("img",{attrs:{src:"img/svg/logo.svg",alt:"Логотип интернет-магазина Moire"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer__bottom-block"},[e("span",{staticClass:"footer__copy common-font"},[t._v("© 2020 Moire")]),e("a",{staticClass:"footer__politics-link common-font link",attrs:{href:"#"}},[t._v("Политика конфиденциальности")]),e("a",{staticClass:"common-font link",attrs:{href:"#"}},[t._v("Публичная оферта")])])}],i=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"cart-indicator",attrs:{href:"#",to:{name:"cart"}}},[e("svg",{attrs:{width:"18",height:"23",fill:"currentColor"}},[e("use",{attrs:{href:"#icon-cart"}})]),e("span",{staticClass:"cart-indicator__counter"},[t._v(" "+t._s(t.$store.state.cartProductsData.length)+" ")])])},c=[],n={name:"CartIndicator"},l=n,d=r(1001),u=(0,d.Z)(l,i,c,!1,null,null,null),p=u.exports,_=r(3822),m={components:{CartIndicator:p},name:"app",methods:{...(0,_.nv)(["loadCart"]),...(0,_.OI)(["updateUserAccessKey"])},created(){const t=localStorage.getItem("userAccessKey");t&&this.updateUserAccessKey(t),this.loadCart()}},h=m,g=(0,d.Z)(h,a,o,!1,null,null,null),v=g.exports,f=r(2631),C=function(){var t=this,e=t._self._c;return e("main",{staticClass:"catalog container"},[e("div",{staticClass:"catalog__title-wrap"},[e("h1",{staticClass:"main-title"},[t._v("Каталог")]),e("span",{staticClass:"catalog__products-quantity"},[t._v(t._s(t.productsQuantity)+" "+t._s(t.quantityNaming))]),e("button",{staticClass:"catalog__filter-control btn btn-primary",on:{click:t.toggleFilter}},[t._v(t._s(t.filterControlText))])]),t.choosenCategory?e("ProductFilter",{attrs:{show:!t.isFilterHidden,"price-from":t.filterPriceFrom,"price-to":t.filterPriceTo,"choosen-category":t.choosenCategory,"choosen-colors":t.choosenColors,"choosen-materials":t.choosenMaterials,"choosen-seasons":t.choosenSeasons},on:{"update:priceFrom":function(e){t.filterPriceFrom=e},"update:price-from":function(e){t.filterPriceFrom=e},"update:priceTo":function(e){t.filterPriceTo=e},"update:price-to":function(e){t.filterPriceTo=e},"update:choosenCategory":function(e){t.choosenCategory=e},"update:choosen-category":function(e){t.choosenCategory=e},"update:choosenColors":function(e){t.choosenColors=e},"update:choosen-colors":function(e){t.choosenColors=e},"update:choosenMaterials":function(e){t.choosenMaterials=e},"update:choosen-materials":function(e){t.choosenMaterials=e},"update:choosenSeasons":function(e){t.choosenSeasons=e},"update:choosen-seasons":function(e){t.choosenSeasons=e}}}):t._e(),t.productsLoading?e("BaseSpinner"):t._e(),t.productsData?e("ProductList",{attrs:{products:t.products}}):t._e(),t.productsLoadingFailed?e("h2",{staticClass:"status-report"},[t._v("Извините, загрузить товары не удалось")]):t._e(),e("BasePagination",{attrs:{count:t.productsQuantity,"per-page":t.productsPerPage},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)},b=[],y=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"drop"}},[e("form",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"filters",on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("fieldset",{staticClass:"filters__filter"},[e("legend",{staticClass:"filters__legend"},[t._v("Цена")]),e("label",{staticClass:"filters__input-label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentPriceFrom,expression:"currentPriceFrom"}],staticClass:"filters__input common-text",attrs:{type:"number",name:"min-price"},domProps:{value:t.currentPriceFrom},on:{input:function(e){e.target.composing||(t.currentPriceFrom=e.target.value)}}})]),e("label",{staticClass:"filters__input-label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentPriceTo,expression:"currentPriceTo"}],staticClass:"filters__input common-text",attrs:{type:"number",name:"max-price"},domProps:{value:t.currentPriceTo},on:{input:function(e){e.target.composing||(t.currentPriceTo=e.target.value)}}})])]),e("fieldset",{staticClass:"filters__filter"},[e("legend",{staticClass:"filters__legend"},[t._v("Категория")]),e("select",{staticClass:"visually-hidden",domProps:{value:t.currentCategory.title}},[e("option",{attrs:{value:"0"}},[t._v("Все товары")]),t._l(t.categories,(function(r){return e("option",{key:r.id},[t._v(t._s(r.title))])}))],2)]),e("v-select",{attrs:{options:t.categories,label:"title"},model:{value:t.currentCategory,callback:function(e){t.currentCategory=e},expression:"currentCategory"}}),t.colorsLoading?e("h2",[t._v("LOADING")]):t._e(),t.colorsData?e("fieldset",{staticClass:"filters__filter"},[e("legend",{staticClass:"filters__legend"},[t._v("Цвет")]),e("ul",{staticClass:"filters__color-list color-list"},t._l(t.colors,(function(r){return e("li",{key:`color_${r.id}`,staticClass:"color-list__item"},[e("label",{staticClass:"color-list__color color"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentColors,expression:"currentColors"}],staticClass:"color__input visually-hidden",attrs:{type:"checkbox"},domProps:{value:r,checked:Array.isArray(t.currentColors)?t._i(t.currentColors,r)>-1:t.currentColors},on:{change:function(e){var s=t.currentColors,a=e.target,o=!!a.checked;if(Array.isArray(s)){var i=r,c=t._i(s,i);a.checked?c<0&&(t.currentColors=s.concat([i])):c>-1&&(t.currentColors=s.slice(0,c).concat(s.slice(c+1)))}else t.currentColors=o}}}),e("span",{staticClass:"color__skin",style:`background-color: ${r.code}`})])])})),0)]):t._e(),t.materialsLoading?e("h2",[t._v("LOADING")]):t._e(),t.materialsData?e("fieldset",{staticClass:"filters__filter"},[e("legend",{staticClass:"filters__legend"},[t._v("Материал")]),e("ul",{staticClass:"filters__material-list square-check-list"},t._l(t.materials,(function(r){return e("li",{key:`material_${r.id}`,staticClass:"material-list__item"},[e("label",{staticClass:"material-list__material square-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentMaterials,expression:"currentMaterials"}],staticClass:"square-check__input visually-hidden",attrs:{type:"checkbox"},domProps:{value:r,checked:Array.isArray(t.currentMaterials)?t._i(t.currentMaterials,r)>-1:t.currentMaterials},on:{change:function(e){var s=t.currentMaterials,a=e.target,o=!!a.checked;if(Array.isArray(s)){var i=r,c=t._i(s,i);a.checked?c<0&&(t.currentMaterials=s.concat([i])):c>-1&&(t.currentMaterials=s.slice(0,c).concat(s.slice(c+1)))}else t.currentMaterials=o}}}),e("span",{staticClass:"square-check__skin"}),e("span",{staticClass:"square-check__value"},[t._v(t._s(r.title))]),e("span",{staticClass:"square-check__amount"},[t._v("("+t._s(r.productsCount)+")")])])])})),0)]):t._e(),t.seasonsLoading?e("h2",[t._v("LOADING")]):t._e(),t.seasonsData?e("fieldset",{staticClass:"filters__filter"},[e("legend",{staticClass:"filters__legend"},[t._v("Коллекция")]),e("ul",{staticClass:"filters__material-list square-check-list"},t._l(t.seasons,(function(r){return e("li",{key:`season_${r.id}`,staticClass:"material-list__item"},[e("label",{staticClass:"material-list__material square-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentSeasons,expression:"currentSeasons"}],staticClass:"square-check__input visually-hidden",attrs:{type:"checkbox"},domProps:{value:r,checked:Array.isArray(t.currentSeasons)?t._i(t.currentSeasons,r)>-1:t.currentSeasons},on:{change:function(e){var s=t.currentSeasons,a=e.target,o=!!a.checked;if(Array.isArray(s)){var i=r,c=t._i(s,i);a.checked?c<0&&(t.currentSeasons=s.concat([i])):c>-1&&(t.currentSeasons=s.slice(0,c).concat(s.slice(c+1)))}else t.currentSeasons=o}}}),e("span",{staticClass:"square-check__skin"}),e("span",{staticClass:"square-check__value"},[t._v(t._s(r.title))]),e("span",{staticClass:"square-check__amount"},[t._v("("+t._s(r.productsCount)+")")])])])})),0)]):t._e(),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Применить")]),t.isFilterActive?e("button",{staticClass:"btn btn-trans",on:{click:function(e){return e.preventDefault(),t.reset.apply(null,arguments)}}},[t._v("сбросить")]):t._e()],1)])},k=[],P=r(6265),D=r.n(P),A=r(4226),w=r.n(A);const E="https://vue-moire.skillbox.cc";var S={name:"ProductFilter",components:{vSelect:w()},props:{show:Boolean,priceFrom:Number,priceTo:Number,choosenCategory:Object,choosenColors:Array,choosenMaterials:Array,choosenSeasons:Array},data(){return{currentPriceFrom:0,currentPriceTo:0,currentCategory:{id:0,title:"Все товары"},currentColors:[],currentMaterials:[],currentSeasons:[],categoriesData:null,categoriesLoading:!1,categoriesLoadingFailed:!1,colorsData:null,colorsLoading:!1,colorsLoadingFailed:!1,materialsData:null,materialsLoading:!1,materialsLoadingFailed:!1,seasonsData:null,seasonsLoading:!1,seasonsLoadingFailed:!1}},computed:{categories(){return this.categoriesData?this.categoriesData.items:[]},colors(){return this.colorsData?this.colorsData.items:[]},materials(){return this.materialsData?this.materialsData.items:[]},seasons(){return this.seasonsData?this.seasonsData.items:[]},isFilterActive(){return 0!==this.priceFrom||0!==this.priceTo||0!==this.choosenCategory.id||this.choosenColors.length>0||this.choosenMaterials.length>0||this.choosenSeasons.length>0}},methods:{submit(){this.$emit("update:priceFrom",Number(this.currentPriceFrom)),this.$emit("update:priceTo",Number(this.currentPriceTo)),this.$emit("update:choosenCategory",this.currentCategory),this.$emit("update:choosenColors",this.currentColors),this.$emit("update:choosenMaterials",this.currentMaterials),this.$emit("update:choosenSeasons",this.currentSeasons)},reset(){this.currentPriceFrom=0,this.currentPriceTo=0,this.currentCategory={id:0,title:"Все товары"},this.currentColors=[],this.currentMaterials=[],this.currentSeasons=[],this.submit()},loadCategories(){this.categoriesLoading=!0,this.categoriesLoadingFailed=!1,D().get(E+"/api/productCategories").then((t=>this.categoriesData=t.data)).catch((()=>this.categoriesLoadingFailed=!0)).then((()=>this.categoriesLoading=!1))},loadColors(){this.colorsLoading=!0,this.colorsLoadingFailed=!1,D().get(`${E}/api/colors`).then((t=>{this.colorsData=t.data})).catch((()=>this.colorsLoadingFailed=!0)).then((()=>this.colorsLoading=!1))},loadMaterials(){this.materialsLoading=!0,this.materialsLoadingFailed=!1,D().get(`${E}/api/materials`).then((t=>{this.materialsData=t.data})).catch((()=>this.materialsLoadingFailed=!0)).then((()=>this.materialsLoading=!1))},loadSeasons(){this.seasonsLoading=!0,this.seasonsLoadingFailed=!1,D().get(`${E}/api/seasons`).then((t=>{this.seasonsData=t.data})).catch((()=>this.seasonsLoadingFailed=!0)).then((()=>this.seasonsLoading=!1))}},created(){this.currentCategory=this.choosenCategory,this.loadCategories(),this.loadColors(),this.loadMaterials(),this.loadSeasons()}},F=S,I=(0,d.Z)(F,y,k,!1,null,null,null),L=I.exports,x=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"catalog__list"},t._l(t.products,(function(t){return e("ProductItem",{key:t.id,attrs:{product:t,id:`product_${t.id}`}})})),1)},T=[],$=function(){var t=this,e=t._self._c;return e("li",{staticClass:"catalog__card-wrap"},[e("article",{staticClass:"catalog__card product"},[e("router-link",{staticClass:"product__link",attrs:{href:"#",to:{name:"product",params:{id:t.product.id}}}},[e("img",{staticClass:"product__img",attrs:{src:t.getImage(),alt:t.product.title}})]),e("h2",{staticClass:"product__title bigger-font"},[t._v(t._s(t.product.title))]),e("div",{staticClass:"product__options"},[e("span",{staticClass:"product__price"},[t._v(t._s(t._f("numberFormat")(t.product.price))+" ₽")]),e("fieldset",{staticClass:"product__colors"},t._l(t.product.colors,(function(r){return e("label",{key:`${t.product.id}_${r.id}`,staticClass:"product__color color"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.productColorCode,expression:"productColorCode"}],staticClass:"color__input visually-hidden",attrs:{type:"radio"},domProps:{value:r.color.code,checked:t._q(t.productColorCode,r.color.code)},on:{change:function(e){t.productColorCode=r.color.code}}}),e("span",{staticClass:"color__skin",style:`background-color: ${r.color.code}`})])})),0)]),e("button",{staticClass:"btn btn-trans product__add-btn",on:{click:t.addToCart}},[t._v("Добавить в корзину")]),t.productAddSending?e("BaseSpinner"):t._e(),e("ItemError",{attrs:{error:t.productAddSendingError,message:t.errorMessage},on:{"update:error":function(e){t.productAddSendingError=e}}})],1)])},M=[];function N(t){return(new Intl.NumberFormat).format(Number(t))}var V={data(){return{productColorCode:""}},methods:{getImage(){if(this.currentColor)try{return this.currentColor.gallery[0].file.url}catch{return"./img/svg/no-img.svg"}return""},getColor(t){return t?t.code:"#fff"}},computed:{currentColor(){return this.productColorCode?this.product.colors.find((t=>t.color.code===this.productColorCode)):""}},filters:{numberFormat:N}},O=function(){var t=this;t._self._c;return t._m(0)},q=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"overlay"},[e("div",{staticClass:"dot-spinner"},[e("div",{staticClass:"dot-spinner__dot"}),e("div",{staticClass:"dot-spinner__dot"}),e("div",{staticClass:"dot-spinner__dot"}),e("div",{staticClass:"dot-spinner__dot"}),e("div",{staticClass:"dot-spinner__dot"}),e("div",{staticClass:"dot-spinner__dot"}),e("div",{staticClass:"dot-spinner__dot"}),e("div",{staticClass:"dot-spinner__dot"})])])}],Z={name:"spinner"},B=Z,z=(0,d.Z)(B,O,q,!1,null,null,null),K=z.exports,U=function(){var t=this,e=t._self._c;return e("div",{staticClass:"overlay item-error",class:{active:t.error}},[e("div",{staticClass:"error-in-frame"},[e("p",[t._v(t._s(t.message))]),e("button",{staticClass:"btn item-error__btn",on:{click:t.closeError}},[t._v("Принять")])])])},j=[],H={name:"item-error",props:{error:Boolean,message:String},methods:{closeError(){this.$emit("update:error",!1)}}},Q=H,R=(0,d.Z)(Q,U,j,!1,null,null,null),G=R.exports,W={name:"ProductItem",mixins:[V],props:{product:Object},components:{ItemError:G,BaseSpinner:K},data(){return{errorMessage:null,productAddSending:!1,productAddSendingError:!1}},mounted(){this.productColorCode=this.product.colors[0].color.code},methods:{...(0,_.nv)(["sendProductToCart"]),addToCart(){this.productAddSending=!0,this.productAddSendingError=!1,D().get(E+"/api/products/"+this.product.id).then((t=>{const e=t.data.sizes[0].id;this.sendProductToCart({productId:this.product.id,colorId:this.currentColor.color.id,sizeId:e,quantity:1}).then((t=>{this.errorMessage="Товар добавлен в корзину.",this.productAddSendingError=!0,this.productAddSending=!1})).catch((()=>{this.errorMessage="Произошла ошибка. Добавить товар не удалось.",this.productAddSendingError=!0,this.productAddSending=!1}))})).catch((()=>{this.errorMessage="Произошла ошибка. Проверьте соединение с Internet.",this.productAddSendingError=!0,this.productAddSending=!1}))}}},J=W,X=(0,d.Z)(J,$,M,!1,null,"15c17480",null),Y=X.exports,tt={name:"ProductList",props:["products"],components:{ProductItem:Y}},et=tt,rt=(0,d.Z)(et,x,T,!1,null,"67952f2e",null),st=rt.exports,at=function(){var t=this,e=t._self._c;return e("div",{staticClass:"catalog__pagination pagination"},[e("a",{staticClass:"pagination__link pagination__link--arrow",class:{"pagination__link--disabled":1===t.page},attrs:{href:"#","aria-label":"Предыдущая страница"},on:{click:function(e){return e.preventDefault(),t.paginate(t.page-1)}}}),e("ul",{staticClass:"pagination__pages"},t._l(t.pages,(function(r){return e("li",{key:r,staticClass:"pagination__item"},[e("a",{staticClass:"pagination__link",class:{"pagination__link--current":r===t.page},attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.paginate(r)}}},[t._v(" "+t._s(r)+" ")])])})),0),e("a",{staticClass:"pagination__link pagination__link--arrow",class:{"pagination__link--disabled":t.page===t.pages},attrs:{href:"#","aria-label":"Следующая страница"},on:{click:function(e){return e.preventDefault(),t.paginate(t.page+1)}}})])},ot=[],it={name:"base-pagination",model:{prop:"page",event:"paginate"},props:{page:Number,count:Number,perPage:Number},computed:{pages(){return Math.ceil(this.count/this.perPage)}},methods:{paginate(t){this.$emit("paginate",t)}}},ct=it,nt=(0,d.Z)(ct,at,ot,!1,null,null,null),lt=nt.exports,dt={name:"catalog",components:{ProductFilter:L,ProductList:st,BasePagination:lt,BaseSpinner:K},data(){return{page:1,productsPerPage:12,filterPriceFrom:0,filterPriceTo:0,choosenCategory:null,choosenColors:[],choosenMaterials:[],choosenSeasons:[],isFilterHidden:!1,categoriesData:null,productsData:null,productsLoading:!1,productsLoadingFailed:!1}},computed:{products(){return this.productsData?this.productsData.items:[]},productsQuantity(){return this.productsData?this.productsData.pagination.total:0},quantityNaming(){if(4>this.productsQuantity<21)return"товаров";{const t=this.productsQuantity.toString().slice(-1);switch(t){case"1":return"товар";case"2":return"товара";case"3":return"товара";case"4":return"товара";default:return"товаров"}}},filterControlText(){return this.isFilterHidden?"Показать фильтры":"Скрыть фильтры"}},methods:{onResize(){this.updateProductsPerPage();const t=document.body.offsetWidth;this.isFilterHidden=!(t>1225)},updateProductsPerPage(){const t=document.body.offsetWidth;this.productsPerPage=t>1550?12:t<620?2:6},loadProducts(){this.productsLoading=!0,this.productsLoadingFailed=!1,clearTimeout(this.loadProductsTimer),this.loadProductsTimer=setTimeout((()=>{D().get(`${E}/api/products`,{params:{page:this.page,limit:this.productsPerPage,categoryId:this.choosenCategory.id,minPrice:this.filterPriceFrom,maxPrice:this.filterPriceTo,colorIds:this.getIds(this.choosenColors),materialIds:this.getIds(this.choosenMaterials),seasonIds:this.getIds(this.choosenSeasons)}}).then((t=>this.productsData=t.data)).catch((()=>this.productsLoadingFailed=!0)).then((()=>this.productsLoading=!1))}),0)},getIds(t){let e=[];for(let r of t)e.push(r.id);return e},toggleFilter(){this.isFilterHidden=!this.isFilterHidden},setCategories(t){D().get(E+"/api/productCategories").then((e=>{this.categoriesData=e.data.items,this.choosenCategory=this.categoriesData.find((e=>e.id===t))})).catch((()=>console.log("категории не загрузились")))}},watch:{productsPerPage(){this.loadProducts()},page(){this.loadProducts()},filterPriceFrom(){this.loadProducts()},filterPriceTo(){this.loadProducts()},choosenColors(){this.loadProducts()},choosenMaterials(){this.loadProducts()},choosenCategory(){this.loadProducts()},choosenSeasons(){this.loadProducts()}},created(){const t=this.$route.query.id;t?this.setCategories(Number(t)):this.choosenCategory={id:0,title:"Все товары"},this.updateProductsPerPage(),this.loadProducts(),document.addEventListener("resize",this.onResize)},beforeDestroy(){document.removeEventListener("resize",this.onResize)}},ut=dt,pt=(0,d.Z)(ut,C,b,!1,null,null,null),_t=pt.exports,mt=function(){var t=this,e=t._self._c;return t.productLoading?e("div",{staticClass:"container container_loader"},[e("BaseSpinner")],1):t.productLoadingFailed?e("div",{staticClass:"column-flex container"},[e("span",{staticClass:"error-message"},[t._v("Произошла ошибка при загрузке товара...")]),e("button",{on:{click:function(e){return e.preventDefault(),t.loadProduct.apply(null,arguments)}}},[t._v("Попробовать ещё раз")])]):e("main",{staticClass:"product-page container"},[e("ul",{staticClass:"breadcrumbs"},[e("li",{staticClass:"breadcrumbs__item"},[e("router-link",{staticClass:"link-under common-font",attrs:{to:{name:"catalog"},href:"#"}},[t._v(" Каталог ")])],1),t._m(0),e("li",{staticClass:"breadcrumbs__item"},[e("router-link",{staticClass:"link-under common-font",attrs:{to:{name:"catalog",query:{id:t.category.id}},href:"#"}},[t._v(" "+t._s(t.category.title)+" ")])],1),t._m(1),e("li",{staticClass:"breadcrumbs__item"},[e("span",{staticClass:"common-font"},[t._v(" "+t._s(t.product.title)+" ")])])]),e("div",{staticClass:"product-page__productblock productblock"},[e("img",{staticClass:"productblock__img",attrs:{src:t.getImage(),alt:t.product.title}}),e("div",{staticClass:"productblock__data"},[e("span",{staticClass:"productblock__id"},[t._v("Артикул: "+t._s(t.product.id))]),e("h2",{staticClass:"productblock__title"},[t._v(t._s(t.product.title)+" ")]),e("div",{staticClass:"productblock__price-wrap"},[e("ProductAmountChangingItem",{attrs:{product:t.product,"product-start-amount":"1"},on:{updateProductAmount:t.onUpdateProductAmount}}),e("span",{staticClass:"productblock__price"},[t._v(t._s(t._f("numberFormat")(t.product.price))+" ₽")])],1),e("div",{staticClass:"productblock__filters"},[e("div",{staticClass:"productblock__filter"},[e("legend",{staticClass:"productblock__legend"},[t._v("Цвет")]),e("fieldset",{staticClass:"productblock__fieldset productblock__fieldset_colors"},t._l(t.product.colors,(function(r){return e("label",{key:`${t.product.id}_${r.id}`,staticClass:"productblock__color color"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.productColorCode,expression:"productColorCode"}],staticClass:"color__input visually-hidden",attrs:{type:"radio"},domProps:{value:r.color.code,checked:t._q(t.productColorCode,r.color.code)},on:{change:function(e){t.productColorCode=r.color.code}}}),e("span",{staticClass:"color__skin",style:`background-color: ${r.color.code}`})])})),0)]),e("div",{staticClass:"productblock__filter"},[e("legend",{staticClass:"productblock__legend"},[t._v("Размер")]),e("fieldset",{staticClass:"productblock__fieldset"},[e("v-select",{attrs:{options:t.product.sizes,label:"title"},model:{value:t.currentSize,callback:function(e){t.currentSize=e},expression:"currentSize"}})],1)])]),e("button",{staticClass:"btn productblock__add-to-cart-btn",on:{click:t.addToCart}},[t._v("в корзину")]),t.productAddSending?e("BaseSpinner"):t._e(),e("ItemError",{attrs:{error:t.productSendingError,message:t.responseErrorMessage},on:{"update:error":function(e){t.productSendingError=e}}}),e("ItemError",{attrs:{error:t.productBasketSendingError,message:t.basketErrorMessage},on:{"update:error":function(e){t.productBasketSendingError=e}}})],1),t.product.colors.length>1?e("ul",{staticClass:"productblock__preview img-switch"},t._l(t.product.colors,(function(r){return e("li",{key:`${t.product.id}_${r.id}`,staticClass:"img-switch__item"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.productColorCode,expression:"productColorCode"}],staticClass:"img-switch__input visually-hidden",attrs:{type:"radio"},domProps:{value:r.color.code,checked:t._q(t.productColorCode,r.color.code)},on:{change:function(e){t.productColorCode=r.color.code}}}),e("img",{staticClass:"img-switch__img",attrs:{src:t.getPreviewImg(r),alt:`${t.product.title}, цвет: ${r.color.title}`}})])])})),0):t._e(),e("div",{staticClass:"productblock__info-btns"},[e("button",{staticClass:"productblock__info-btn productblock__info-btn_one",class:{active:t.firstTabIsActive},on:{click:t.switchTab}},[t._v("Информация о товаре")]),e("button",{staticClass:"productblock__info-btn productblock__info-btn_two",class:{active:!t.firstTabIsActive},on:{click:t.switchTab}},[t._v("Доставка и возврат")])]),t.firstTabIsActive?e("div",{staticClass:"productblock__info"},[e("h3",{staticClass:"productblock__attribute"},[t._v("Состав:")]),e("ul",{staticClass:"productblock__values"},t._l(t.product.materials,(function(r){return e("li",{key:`${t.product.title}_${r.id}`,staticClass:"productblock__value"},[t._v(" "+t._s(r.title))])})),0)]):t._e(),t.firstTabIsActive?e("div",{staticClass:"productblock__info"},[e("h3",{staticClass:"productblock__attribute"},[t._v("Уход:")]),t._m(2)]):t._e(),!t.firstTabIsActive&&t.deliverData?e("div",{staticClass:"productblock__info"},[e("h3",{staticClass:"productblock__attribute"},[t._v("Доставка:")]),e("ul",{staticClass:"productblock__values"},[t._l(t.deliverData,(function(r){return e("li",{key:`deliver_${r.id}`,staticClass:"productblock__value"},[t._v(" "+t._s(r.title)+" — "+t._s(r.price)+" ₽")])})),t._m(3)],2)]):t._e(),t.firstTabIsActive?t._e():e("div",{staticClass:"productblock__info"},[e("h3",{staticClass:"productblock__attribute"},[t._v("Возврат:")]),t._m(4)])])])},ht=[function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("span",{staticClass:"common-font"},[t._v(" — ")])])},function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("span",{staticClass:"common-font"},[t._v(" — ")])])},function(){var t=this,e=t._self._c;return e("ul",{staticClass:"productblock__values"},[e("li",{staticClass:"productblock__value"},[t._v("Машинная стирка при макс. 30ºC короткий отжим")]),e("li",{staticClass:"productblock__value"},[t._v("Гладить при макс. 110ºC")]),e("li",{staticClass:"productblock__value"},[t._v("Не использовать машинную сушку")]),e("li",{staticClass:"productblock__value"},[t._v("Отбеливать запрещено")]),e("li",{staticClass:"productblock__value"},[t._v("Не подвергать химчистке")])])},function(){var t=this,e=t._self._c;return e("li",{staticClass:"productblock__value"},[t._v("Список и адреса магазинов Вы можете посмотреть "),e("a",{staticClass:"addresses-link link",attrs:{href:"#"}},[t._v("здесь")])])},function(){var t=this,e=t._self._c;return e("ul",{staticClass:"productblock__values"},[e("li",{staticClass:"productblock__value"},[t._v("Любой возврат должен быть осуществлен в течение 30 дней с момента отгрузки.")]),e("li",{staticClass:"productblock__value"},[t._v("Возвраты в магазине БЕСПЛАТНО.")]),e("li",{staticClass:"productblock__value"},[t._v("Вы можете вернуть товары в любой магазин. Магазин должен быть расположен в стране, в которой Вы осуществили покупку.")]),e("li",{staticClass:"productblock__value"},[t._v("БЕСПЛАТНЫЙ возврат в Пункт выдачи заказов.")]),e("li",{staticClass:"productblock__value"},[t._v("Для того чтобы вернуть товар в одном из наших Пунктов выдачи заказов, позвоните по телефону:  "),e("a",{staticClass:"link",attrs:{href:"tel:88006009009"}},[t._v("8 800 600 90 09")])])])}],gt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"counter"},[e("button",{staticClass:"counter__btn",class:{isdisabled:t.productAmount<2},attrs:{"aria-label":"Убрать один товар"},on:{click:t.decreaseProductAmount}},[e("svg",{attrs:{width:"37",height:"37"}},[e("use",{attrs:{href:"#minus"}})])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.productAmount,expression:"productAmount"}],staticClass:"counter__input",attrs:{type:"text"},domProps:{value:t.productAmount},on:{keydown:function(e){return t.pressOnlyNumbers(e,t.productAmount)},input:[function(e){e.target.composing||(t.productAmount=e.target.value)},function(e){return t.fixNSync(t.productAmount)}]}}),e("button",{staticClass:"counter__btn",class:{isdisabled:t.productAmount>98},attrs:{"aria-label":"Добавить один товар"},on:{click:t.increaseProductAmount}},[e("svg",{attrs:{width:"37",height:"37"}},[e("use",{attrs:{href:"#plus"}})])])])},vt=[];function ft(t){if(t=t.toString(),t.length<1)return;const e=/\d+/;let r=Number(t.match(e));return 0!==r?t>99?99:r:void 0}function Ct(t){46==t.keyCode||8==t.keyCode||9==t.keyCode||27==t.keyCode||65==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39||(t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}var bt={name:"product-amount-changing-item",props:["productStartAmount"],data(){return{productAmount:this.productStartAmount}},methods:{fixNSync(t){this.productAmount=this.inputOnlyNumbers(t),this.syncProductAmount()},syncProductAmount(){this.$emit("updateProductAmount",this.productAmount)},increaseProductAmount(){this.productAmount++,this.$emit("updateProductAmount",this.productAmount)},decreaseProductAmount(){this.productAmount>0&&(this.productAmount--,this.$emit("updateProductAmount",this.productAmount))},inputOnlyNumbers:ft,pressOnlyNumbers:Ct}},yt=bt,kt=(0,d.Z)(yt,gt,vt,!1,null,"4addecf0",null),Pt=kt.exports,Dt={name:"product-page",components:{ProductAmountChangingItem:Pt,vSelect:w(),ItemError:G,BaseSpinner:K},mixins:[V],data(){return{productAmount:1,currentSize:"",firstTabIsActive:!0,responseErrorMessage:"Товар не найден. Пожалуйста, выберите другой цвет или размер.",basketErrorMessage:"Товар не добавлен в корзину. Пожалуйста, проверьте соединение с Internet и попробуйте ещё раз.",product:null,productLoading:!1,productLoadingFailed:!1,deliverData:null,deliverLoadingFailed:!1,productAddSending:!1,productSendingError:!1,productBasketSendingError:!1}},computed:{category(){return this.product.category},colorId(){let t=this.product.colors.find((t=>t.color.code===this.productColorCode));return t.color.id}},methods:{...(0,_.nv)(["sendProductToCart"]),addToCart(){this.productAddSending=!0,this.productSendingError=!1,this.productBasketSendingError=!1,this.sendProductToCart({productId:this.product.id,colorId:this.colorId,sizeId:this.currentSize.id,quantity:this.productAmount}).then((t=>{400===t?this.productSendingError=!0:200!==t&&(this.productBasketSendingError=!0)})).catch((()=>{this.productBasketSendingError=!0})).finally((()=>{this.productAddSending=!1}))},onUpdateProductAmount(t){this.productAmount=t},loadDeliver(){this.deliverLoadingFailed=!1,D().get(E+"/api/deliveries/").then((t=>{this.deliverData=t.data})).catch((()=>this.deliverLoadingFailed=!0))},loadProduct(){this.productLoading=!0,this.productLoadingFailed=!1,D().get(E+"/api/products/"+this.$route.params.id).then((t=>{this.product=t.data,this.currentSize=this.product.sizes[0],this.productColorCode=this.product.colors[0].color.code})).catch((()=>this.productLoadingFailed=!0)).then((()=>this.productLoading=!1))},getPreviewImg(t){try{return t.gallery[0].file.url}catch{return"./img/svg/no-img.svg"}},switchTab(){this.firstTabIsActive=!this.firstTabIsActive}},watch:{"$route.params.id":{handler(){this.loadProduct()},immediate:!0}},created(){this.loadDeliver()}},At=Dt,wt=(0,d.Z)(At,mt,ht,!1,null,null,null),Et=wt.exports,St=function(){var t=this,e=t._self._c;return e("main",{staticClass:"cart-page container"},[e("ul",{staticClass:"breadcrumbs"},[e("li",{staticClass:"breadcrumbs__item"},[e("router-link",{staticClass:"link-under common-font",attrs:{to:{name:"catalog"},href:"#"}},[t._v(" Каталог ")])],1),t._m(0),t._m(1)]),t.productsAmount>0?e("div",{staticClass:"cart-page__title-wrap"},[e("h1",{staticClass:"cart-page__title"},[t._v(" Корзина ")]),e("span",{staticClass:"cart-page__products-counter"},[t._v(" товаров: "+t._s(t.productsAmount)+" ")])]):t._e(),t.productsAmount<1?e("h2",{staticClass:"error-message"},[t._v(" Корзина пока пуста. Перейти в "),e("router-link",{staticClass:"cart-page__link",attrs:{to:{name:"catalog"},href:"#"}},[t._v(" Каталог")]),t._v("? ")],1):t._e(),t.productsAmount>0?e("div",{staticClass:"cart-page__content"},[e("ul",{staticClass:"cart-page__products-list"},t._l(t.products,(function(t){return e("CartItem",{key:t.id,attrs:{item:t}})})),1),e("div",{staticClass:"cart-page__order"},[e("span",{staticClass:"cart-page__lesser-heading bigger-font"},[t._v("Мы посчитаем стоимость доставки на следующем этапе")]),e("span",{staticClass:"cart-page__total-price"},[t._v(" Итого:"),e("span",{staticClass:"cart-page__total-price-value"},[t._v(t._s(t._f("numberFormat")(t.totalPrice))+" ₽")])]),e("router-link",{staticClass:"cart-page__order-link btn btn-primary",attrs:{to:{name:"order"},href:"#"}},[t._v("оформить заказ")])],1)]):t._e()])},Ft=[function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("span",{staticClass:"common-font"},[t._v(" — ")])])},function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("span",{staticClass:"common-font"},[t._v(" Корзина ")])])}],It=function(){var t=this,e=t._self._c;return e("li",[e("div",{staticClass:"cart-card"},[e("img",{staticClass:"cart-card__img",attrs:{src:t.getImage(),alt:t.item.product.title}}),e("div",{staticClass:"cart-card__info"},[e("h3",{staticClass:"cart-card__title bigger-font"},[t._v(t._s(t.item.product.title))]),e("div",{staticClass:"cart-card__color-block"},[e("h4",{staticClass:"cart-card__color-title"},[t._v("Цвет:")]),e("span",{staticClass:"cart-card__color",style:`background-color: ${t.item.color.color.code}`}),e("span",{staticClass:"cart-card__color-name"},[t._v(t._s(t.item.color.color.title))])]),e("span",{staticClass:"cart-card__size"},[t._v("Размер: "+t._s(t.item.size.title))]),e("span",{staticClass:"cart-card__code"},[t._v("Артикул: "+t._s(t.item.id))])]),e("div",{staticClass:"cart-card__buttons-block"},[e("div",{staticClass:"cart-card__counter"},[e("ProductAmountChangingItem",{attrs:{product:t.item,"product-start-amount":t.item.quantity},on:{updateProductAmount:t.onUpdateCartProductAmount}})],1),e("span",{staticClass:"cart-card__price"},[t._v(t._s(t._f("numberFormat")(t.item.price))+" ₽")]),e("button",{staticClass:"cart-card__remove-btn",on:{click:function(e){return e.preventDefault(),t.onRemoveCartProduct.apply(null,arguments)}}},[e("svg",{attrs:{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M17 1L1 17",stroke:"#9D9D9D","stroke-width":"0.8"}}),e("path",{attrs:{d:"M17 17L1 0.999999",stroke:"#9D9D9D","stroke-width":"0.8"}})])])]),t.productDeleting?e("BaseSpinner"):t._e(),e("ItemError",{attrs:{error:t.productDeletingError,message:t.errorMessage},on:{"update:error":function(e){t.productDeletingError=e}}})],1)])},Lt=[],xt={name:"CartItem",props:{item:Object},components:{ProductAmountChangingItem:Pt,ItemError:G,BaseSpinner:K},data(){return{errorMessage:"Извините, произошла ошибка. Удалить товар не удалось.",productDeleting:!1,productDeletingError:!1}},filters:{numberFormat:N},methods:{...(0,_.nv)(["removeProductFromBasket","updateCartProductAmount"]),onUpdateCartProductAmount(t){this.updateCartProductAmount({basketItemId:this.item.id,quantity:t})},async onRemoveCartProduct(){this.productDeleting=!0;const t=!await this.removeProductFromBasket(this.item.id);t?(this.productDeleting=!1,this.productDeletingError=!0):this.productDeleting=!1},getImage(){try{return this.item.color.gallery[0].file.url}catch{return"./img/svg/no-img.svg"}}}},Tt=xt,$t=(0,d.Z)(Tt,It,Lt,!1,null,null,null),Mt=$t.exports,Nt={name:"CartPage",components:{CartItem:Mt},computed:{...(0,_.Se)({totalPrice:"cartTotalPrice"}),productsAmount(){return this.products.length},products(){return this.$store.state.cartProductsData}},filters:{numberFormat:N}},Vt=Nt,Ot=(0,d.Z)(Vt,St,Ft,!1,null,null,null),qt=Ot.exports,Zt=function(){var t=this,e=t._self._c;return e("main",{staticClass:"order-page container"},[e("ul",{staticClass:"breadcrumbs"},[e("li",{staticClass:"breadcrumbs__item"},[e("router-link",{staticClass:"link-under common-font",attrs:{to:{name:"catalog"},href:"#"}},[t._v(" Каталог ")])],1),t._m(0),e("li",{staticClass:"breadcrumbs__item"},[e("router-link",{staticClass:"link-under common-font",attrs:{to:{name:"cart"},href:"#"}},[t._v(" Корзина ")])],1),t._m(1)]),e("h1",{staticClass:"order-page__title"},[t._v("Оформление заказа")]),t.products.length<1?e("h2",[t._v("Похоже, корзина пуста")]):t._e(),t.products.length>0?e("form",{staticClass:"order-page__form",attrs:{autocomplete:"true"},on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("fieldset",{staticClass:"order-page__fields"},[e("label",{staticClass:"order-page__field-label empty"},[e("span",{staticClass:"order-page__field-placeholder"},[t._v("ФИО")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.nameValue,expression:"nameValue",modifiers:{trim:!0}}],staticClass:"order-page__field",class:{invalid:t.nameError},domProps:{value:t.nameValue},on:{focus:t.resetNameError,blur:[t.setEmpty,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.nameValue=e.target.value.trim())}}}),t.nameError?e("span",{staticClass:"validation-error"},[t._v(t._s(t.nameError))]):t._e()]),e("label",{staticClass:"order-page__field-label empty"},[e("span",{staticClass:"order-page__field-placeholder"},[t._v("Адрес доставки")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressValue,expression:"addressValue",modifiers:{trim:!0}}],staticClass:"order-page__field",class:{invalid:t.addressError},domProps:{value:t.addressValue},on:{focus:t.resetAddressError,blur:[t.setEmpty,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.addressValue=e.target.value.trim())}}}),t.addressError?e("span",{staticClass:"validation-error"},[t._v(t._s(t.addressError))]):t._e()]),e("label",{staticClass:"order-page__field-label half-width empty"},[e("span",{staticClass:"order-page__field-placeholder"},[t._v("Телефон")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.phoneValue,expression:"phoneValue",modifiers:{trim:!0}},{name:"mask",rawName:"v-mask",value:"(###)-###-##-##",expression:"'(###)-###-##-##'"}],staticClass:"order-page__field",class:{invalid:t.phoneError},attrs:{id:"phone-input"},domProps:{value:t.phoneValue},on:{focus:t.resetPhoneError,blur:[t.setEmpty,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.phoneValue=e.target.value.trim())}}}),t.phoneError?e("span",{staticClass:"validation-error"},[t._v(t._s(t.phoneError))]):t._e()]),e("label",{staticClass:"order-page__field-label half-width empty"},[e("span",{staticClass:"order-page__field-placeholder"},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.emailValue,expression:"emailValue",modifiers:{trim:!0}}],staticClass:"order-page__field",class:{invalid:t.emailError},domProps:{value:t.emailValue},on:{focus:t.resetEmailError,blur:[t.setEmpty,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.emailValue=e.target.value.trim())}}}),t.emailError?e("span",{staticClass:"validation-error"},[t._v(t._s(t.emailError))]):t._e()]),e("label",{staticClass:"order-page__field-label empty"},[e("span",{staticClass:"order-page__field-placeholder"},[t._v("Комментарий к заказу")]),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.commentsValue,expression:"commentsValue",modifiers:{trim:!0}}],staticClass:"order-page__field",attrs:{rows:"4"},domProps:{value:t.commentsValue},on:{focus:t.removeEmpty,blur:[t.setEmpty,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.commentsValue=e.target.value.trim())}}})])]),e("OrderList",{attrs:{products:t.products,delivery:t.currentDelivery,"total-price":t.totalPrice}},[e("button",{staticClass:"order-page__submit-btn btn btn-primary",attrs:{type:"submit"}},[t._v("Оформить заказ")])]),t.deliverData?e("div",{staticClass:"order-page__options"},[e("fieldset",{staticClass:"order-page__option"},[e("h2",{staticClass:"order-page__option-name"},[t._v("Доставка")]),t._l(t.deliverData,(function(r){return e("label",{key:`deliver_${r.id}`,staticClass:"order-page__radio-label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.productDelivery,expression:"productDelivery"}],staticClass:"order-page__radio-input visually-hidden",attrs:{type:"radio",name:"delivery"},domProps:{value:r.id,checked:t._q(t.productDelivery,r.id)},on:{change:function(e){t.productDelivery=r.id}}}),e("span",{staticClass:"order-page__radio-inner"},[e("span",{staticClass:"order-page__radio-sign"}),t._v(" "+t._s(r.title)+" "+t._s(t._f("numberFormat")(r.price))+" ₽ ")])])}))],2),t.paymentData?e("fieldset",{staticClass:"order-page__option"},[e("h2",{staticClass:"order-page__option-name"},[t._v("Оплата")]),t._l(t.paymentData,(function(r){return e("label",{key:`payment_${r.id}`,staticClass:"order-page__radio-label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.productPaySource,expression:"productPaySource"}],staticClass:"order-page__radio-input visually-hidden",attrs:{type:"radio",name:"pay"},domProps:{value:r.id,checked:t._q(t.productPaySource,r.id)},on:{change:function(e){t.productPaySource=r.id}}}),e("span",{staticClass:"order-page__radio-inner"},[e("span",{staticClass:"order-page__radio-sign"}),t._v(" "+t._s(r.title)+" ")])])}))],2):t._e()]):t._e(),t.orderError?e("div",{staticClass:"order-page__error-block error-in-frame"},[t.orderErrorTitle?e("h2",{staticClass:"order-page__error-title"},[t._v(t._s(t.orderErrorTitle))]):t._e(),e("p",{staticClass:"order-page__error-message"},[t._v(t._s(t.orderErrorMessage))])]):t._e()],1):t._e()])},Bt=[function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("span",{staticClass:"common-font"},[t._v(" — ")])])},function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("span",{staticClass:"common-font"},[t._v(" Оформление заказа ")])])}],zt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-list"},[e("button",{staticClass:"order-list__show-list-btn btn btn-trans",attrs:{type:"button"},on:{click:t.toggleShow}},[t._v(t._s(t.showBtnText))]),e("transition",{attrs:{name:"scroll"}},[e("ul",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"order-list__products"},t._l(t.products,(function(t){return e("OrderItem",{key:t.id,attrs:{item:t}})})),1)]),e("div",{staticClass:"order-list__submit"},[t.delivery?e("span",{staticClass:"order-list__total"},[t._v("Доставка: "),e("b",[t._v(t._s(t._f("numberFormat")(t.delivery.price))+" ₽")])]):t._e(),t.delivery?e("span",{staticClass:"order-list__total"},[t._v("Итого: "),e("b",[t._v(t._s(t.products.length))]),t._v(" товара на сумму "),e("b",[t._v(t._s(t._f("numberFormat")(Number(t.totalPrice)+Number(t.delivery.price)))+" ₽")])]):e("span",{staticClass:"order-list__total"},[t._v("Выберите способ доставки для окончательного расчёта")]),t._t("default")],2)],1)},Kt=[],Ut=function(){var t=this,e=t._self._c;return e("li",{staticClass:"order-product"},[e("span",{staticClass:"order-product__title bigger-font"},[t._v(t._s(t.item.product.title))]),e("b",{staticClass:"order-product__price"},[t._v(t._s(t._f("numberFormat")(t.item.price))+" ₽")]),e("span",{staticClass:"order-product__attribute order-product__attribute_code"},[e("span",{staticClass:"note-color"},[t._v("Артикул:")]),t._v(" "+t._s(t.item.id))]),e("span",{staticClass:"order-product__attribute order-product__attribute_amount"},[e("span",{staticClass:"note-color"},[t._v("Количество:")]),t._v(" "+t._s(t.item.quantity))]),e("span",{staticClass:"order-product__attribute order-product__attribute_size"},[e("span",{staticClass:"note-color"},[t._v("Размер:")]),t._v(" "+t._s(t.item.size.title))]),e("span",{staticClass:"order-product__attribute order-product__attribute_color"},[e("span",{staticClass:"note-color"},[t._v("Цвет:")]),t._v(" "+t._s(t.item.color.color.title))])])},jt=[],Ht={name:"OrderItem",props:{item:Object},filters:{numberFormat:N}},Qt=Ht,Rt=(0,d.Z)(Qt,Ut,jt,!1,null,null,null),Gt=Rt.exports,Wt={name:"OrderList",props:["products","delivery","totalPrice"],components:{OrderItem:Gt},filters:{numberFormat:N},data(){return{show:!0,showBtnText:"Скрыть список покупок"}},methods:{toggleShow(){this.show=!this.show,this.showBtnText=this.show?"Скрыть список покупок":"Показать список покупок"}},created(){window.addEventListener("resize",(()=>{const t=document.body.offsetWidth;t>1225&&(this.show=!0,this.showBtnText="Скрыть список покупок")}))}},Jt=Wt,Xt=(0,d.Z)(Jt,zt,Kt,!1,null,null,null),Yt=Xt.exports,te=r(2904);s.ZP.use(te.ZP);var ee={name:"order-page",components:{OrderList:Yt},data(){return{productDelivery:null,productPaySource:null,nameValue:"",addressValue:"",phoneValue:"",emailValue:"",commentsValue:"",nameError:!1,addressError:!1,phoneError:!1,emailError:!1,commentsError:!1,deliverData:null,deliverLoadingFailed:!1,paymentData:null,paymentLoadingFailed:!1,orderErrorTitle:null,orderErrorMessage:null}},computed:{...(0,_.Se)({totalPrice:"cartTotalPrice"}),products(){return this.$store.state.cartProductsData},productsAmount(){return this.products().length},currentDelivery(){return this.deliverData?this.deliverData.find((t=>t.id===this.productDelivery)):null},currentPayment(){return this.paymentData?this.paymentData.find((t=>t.id===productPaySource)).title:null},formValidity(){return!(this.nameError||this.phoneError||this.emailError||this.addressError)},orderError(){return!!this.orderErrorMessage}},methods:{...(0,_.OI)(["clearCart"]),async submitForm(){if(this.orderErrorMessage=null,this.formValidation(),null===this.productPaySource)this.orderErrorMessage="Пожалуйста, выберите способ оплаты и доставки",setTimeout(this.resetOrderErrorMessage,4e3);else if(this.formValidity){const t=await this.sendOrder();t?(this.clearCart(),this.$router.push({name:"orderInfo",params:{id:t.data.id}})):(this.orderErrorMessage="Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу.",console.log("отправка заказа неудачна"))}else document.querySelector(".order-page__form").scrollIntoView({behavior:"smooth",block:"start"})},formValidation(){const t=/^[А-Яа-яA-Za-z ]+$/,e=/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/iu;function r(t){let e=[];for(let r=0;r<t.length;r++)isNaN(Number(t[r]))||e.push(t[r]);return console.log(e),e}""===this.nameValue?this.nameError="Заполните поле":this.nameValue.match(t)||(this.nameError="допустимы только буквы"),""===this.addressValue&&(this.addressError="Заполните поле");const s=r(this.phoneValue);""===this.phoneValue?this.phoneError="Заполните поле":10!==s.length&&(this.phoneError="введите номер в 10-значном формате"),""===this.emailValue?this.emailError="Заполните поле":this.emailValue.match(e)||(this.emailError="неверный формат")},removeEmpty(t){t.target.closest(".order-page__field-label").classList.remove("empty")},setEmpty(t){""===t.target.value.trim()&&t.target.closest(".order-page__field-label").classList.add("empty")},resetNameError(t){this.removeEmpty(t),this.nameError=!1},resetPhoneError(t){this.removeEmpty(t),this.phoneError=!1},resetEmailError(t){this.removeEmpty(t),this.emailError=!1},resetAddressError(t){this.removeEmpty(t),this.addressError=!1},resetOrderErrorMessage(){this.orderErrorMessage=null},loadDeliver(){this.deliverLoadingFailed=!1,D().get(E+"/api/deliveries/").then((t=>{this.deliverData=t.data})).catch((()=>this.deliverLoadingFailed=!0))},getPaymentData(){this.currentDelivery&&(this.paymentLoadingFailed=!1,D().get(E+"/api/payments/",{params:{deliveryTypeId:this.productDelivery}}).then((t=>{this.paymentData=t.data})).catch((()=>this.paymentLoadingFailed=!0)))},async sendOrder(){let t;try{let e="+7"+this.phoneValue;t=await D().post(E+"/api/orders",{name:this.nameValue,address:this.addressValue,phone:e,email:this.emailValue,deliveryTypeId:this.productDelivery,paymentTypeId:this.productPaySource,comment:this.commentValue},{params:{userAccessKey:this.$store.state.userAccessKey}})}catch(e){console.log("error",e)}return t}},filters:{numberFormat:N},created(){this.loadDeliver()},watch:{productDelivery(){this.getPaymentData()}}},re=ee,se=(0,d.Z)(re,Zt,Bt,!1,null,"fb78f214",null),ae=se.exports,oe=function(){var t=this,e=t._self._c;return t.dataLoading?e("BaseSpinner"):t.orderData?e("main",{staticClass:"order-info-page container"},[e("h1",{staticClass:"order-info-page__title"},[t._v("Заказ оформлен "),e("span",{staticClass:"order-info-page__order-num"},[t._v("№"+t._s(t.orderData.id))])]),e("div",{staticClass:"order-info-page__content"},[e("p",{staticClass:"order-info-page__message"},[t._v("Благодарим за выбор нашего магазина. На Вашу почту придет письмо с деталями заказа. Наши менеджеры свяжутся с Вами в течение часа для уточнения деталей доставки.")]),e("OrderList",{attrs:{products:t.products,delivery:t.delivery,"total-price":t.totalPrice}}),e("dl",{staticClass:"order-info-page__costumer-info"},[e("dt",{staticClass:"order-info-page__costumer-key"},[t._v("получатель")]),e("dd",{staticClass:"order-info-page__costumer-value"},[t._v(t._s(t.orderData.name))]),e("dt",{staticClass:"order-info-page__costumer-key"},[t._v("Адрес доставки")]),e("dd",{staticClass:"order-info-page__costumer-value"},[t._v(t._s(t.orderData.address))]),e("dt",{staticClass:"order-info-page__costumer-key"},[t._v("Телефон")]),e("dd",{staticClass:"order-info-page__costumer-value"},[t._v(t._s(t.orderData.phone))]),e("dt",{staticClass:"order-info-page__costumer-key"},[t._v("Email")]),e("dd",{staticClass:"order-info-page__costumer-value"},[t._v(t._s(t.orderData.email))]),e("dt",{staticClass:"order-info-page__costumer-key"},[t._v("Способ оплаты")]),e("dd",{staticClass:"order-info-page__costumer-value"},[t._v(t._s(t.orderData.paymentType))])])],1)]):e("h1",{staticClass:"order-info-page__title"},[t._v("Извините, заказ не найден")])},ie=[],ce={name:"OrderInfoPage",components:{OrderList:Yt,BaseSpinner:K},filters:{numberFormat:N},data(){return{orderData:null,dataLoading:!1,dataLoadingFailed:!1}},methods:{loadOrderData(){this.dataLoadingFailed=!1,this.dataLoading=!0,D().get(E+"/api/orders/"+this.$route.params.id,{params:{userAccessKey:this.$store.state.userAccessKey}}).then((t=>{this.orderData=t.data})).catch((()=>this.dataLoadingFailed=!0)).finally((()=>this.dataLoading=!1))}},computed:{products(){return this.orderData?this.orderData.basket.items:null},delivery(){return this.orderData?this.orderData.deliveryType:null},totalPrice(){return this.orderData?this.orderData.totalPrice:null}},watch:{"$route.params.id":{handler(){this.loadOrderData()},immediate:!0}}},ne=ce,le=(0,d.Z)(ne,oe,ie,!1,null,null,null),de=le.exports,ue=function(){var t=this,e=t._self._c;return e("main",{staticClass:"not-found"},[e("h1",{staticClass:"not-found__header"},[t._v("Страница не найдена")]),e("router-link",{staticClass:"not-found__home-link link",attrs:{href:"#",to:{name:"catalog"}}},[t._v("Перейти в каталог")])],1)},pe=[],_e={name:"not-found-page"},me=_e,he=(0,d.Z)(me,ue,pe,!1,null,null,null),ge=he.exports;s.ZP.use(f.Z);const ve=[{name:"catalog",component:_t,path:"/"},{name:"product",component:Et,path:"/product/:id"},{name:"cart",component:qt,path:"/cart"},{name:"order",component:ae,path:"/order"},{name:"orderInfo",component:de,path:"/order-info/:id"},{name:"notFound",component:ge,path:"*"}],fe=new f.Z({base:"/Moire/",routes:ve});var Ce=fe;s.ZP.use(_.ZP);var be=new _.ZP.Store({state:{userAccessKey:null,cartProductsData:[]},getters:{cartTotalPrice(t,e){return t.cartProductsData.reduce(((t,e)=>e.price*e.quantity+t),0)}},mutations:{updateUserAccessKey(t,e){t.userAccessKey=e},updateCartProductsData(t,e){t.cartProductsData=e},clearCart(t){t.cartProductsData=[]}},actions:{loadCart(t){D().get(E+"/api/baskets",{params:{userAccessKey:t.state.userAccessKey}}).then((e=>{t.state.userAccessKey||(localStorage.setItem("userAccessKey",e.data.user.accessKey),t.commit("updateUserAccessKey",e.data.user.accessKey)),t.commit("updateCartProductsData",e.data.items)}))},sendProductToCart(t,{productId:e,colorId:r,sizeId:s,quantity:a}){return D().post(E+"/api/baskets/products",{productId:e,colorId:r,sizeId:s,quantity:a},{params:{userAccessKey:t.state.userAccessKey}}).then((e=>(t.commit("updateCartProductsData",e.data.items),e.status))).catch((t=>t.response.status))},updateCartProductAmount(t,{basketItemId:e,quantity:r}){return D().put(E+"/api/baskets/products",{basketItemId:e,quantity:r},{params:{userAccessKey:t.state.userAccessKey}}).then((e=>{t.commit("updateCartProductsData",e.data.items)}))},removeProductFromBasket(t,e){return D()["delete"](`${E}/api/baskets/products`,{params:{userAccessKey:t.state.userAccessKey},data:{basketItemId:e}}).then((e=>(t.commit("updateCartProductsData",e.data.items),!0))).catch((()=>(console.log("smth went wrong"),!1)))}},modules:{}});s.ZP.config.productionTip=!1,new s.ZP({router:Ce,store:be,render:t=>t(v)}).$mount("#app")}},e={};function r(s){var a=e[s];if(void 0!==a)return a.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,r),o.exports}r.m=t,function(){var t=[];r.O=function(e,s,a,o){if(!s){var i=1/0;for(d=0;d<t.length;d++){s=t[d][0],a=t[d][1],o=t[d][2];for(var c=!0,n=0;n<s.length;n++)(!1&o||i>=o)&&Object.keys(r.O).every((function(t){return r.O[t](s[n])}))?s.splice(n--,1):(c=!1,o<i&&(i=o));if(c){t.splice(d--,1);var l=a();void 0!==l&&(e=l)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[s,a,o]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};r.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,o,i=s[0],c=s[1],n=s[2],l=0;if(i.some((function(e){return 0!==t[e]}))){for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(n)var d=n(r)}for(e&&e(s);l<i.length;l++)o=i[l],r.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return r.O(d)},s=self["webpackChunkmoire"]=self["webpackChunkmoire"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=r.O(void 0,[998],(function(){return r(8643)}));s=r.O(s)})();
//# sourceMappingURL=app.d9581326.js.map